(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{589:function(v,_,t){"use strict";t.r(_);var a=t(17),e=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"字节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字节"}},[v._v("#")]),v._v(" 字节")]),v._v(" "),t("h2",{attrs:{id:"字节提前批-国际化电商"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字节提前批-国际化电商"}},[v._v("#")]),v._v(" 字节提前批-国际化电商")]),v._v(" "),t("h3",{attrs:{id:"消息丢失-补偿机制是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#消息丢失-补偿机制是什么"}},[v._v("#")]),v._v(" 消息丢失，补偿机制是什么")]),v._v(" "),t("ul",[t("li",[v._v("补偿：失败重试，未发送成功的消息，失败后重新发送")]),v._v(" "),t("li",[v._v("回调：发送一个正常的消息，发送一个延迟消息，延迟的消息收到后，正常的消息没有消费")]),v._v(" "),t("li",[v._v("定时比较两个数据的一致性："),t("code",[v._v("DB")]),v._v("（数据库）和"),t("code",[v._v("MDB")]),v._v("（微软数据库）")]),v._v(" "),t("li",[v._v("延伸："),t("code",[v._v("MQ")]),v._v(" "),t("ul",[t("li",[v._v("问题：\n"),t("ul",[t("li",[v._v("消息没到交换机，消息到交换机，没到队列")]),v._v(" "),t("li",[v._v("宕机后消息丢失")]),v._v(" "),t("li",[v._v("消费者还未来得及消费，队列已经把消息删除")])])]),v._v(" "),t("li",[v._v("解决：\n"),t("ul",[t("li",[v._v("生产者确认：保证消息到队列")]),v._v(" "),t("li",[v._v("持久化：保证宕机后消息还在")]),v._v(" "),t("li",[v._v("消费者确认：保证消费者拿到消息后不立刻删除")]),v._v(" "),t("li",[v._v("失败重试：默认无限重试，为了保证性能，设置次数和间隔时间重试")])])])])])]),v._v(" "),t("h3",{attrs:{id:"消息重复后怎么做"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#消息重复后怎么做"}},[v._v("#")]),v._v(" 消息重复后怎么做")]),v._v(" "),t("p",[v._v("服务质量低到高")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("at most once")]),v._v("：最多一次")]),v._v(" "),t("li",[t("code",[v._v("at least once")]),v._v("（默认）：至少一次")]),v._v(" "),t("li",[t("code",[v._v("exactly once")]),v._v("：一次，不适用，因为要时刻回查保证消息不丢失不重复")])]),v._v(" "),t("p",[v._v("解决：幂等性")]),v._v(" "),t("ul",[t("li",[v._v("概念：多次调用和一次调用效果一样（ "),t("code",[v._v("at least once")]),v._v("+ 幂等性="),t("code",[v._v("exactly once")]),v._v("）")]),v._v(" "),t("li",[v._v("实现：\n"),t("ul",[t("li",[t("code",[v._v("MVCC")]),v._v("（多版本并发控制），"),t("code",[v._v("version")]),v._v("一致数据更新，之后"),t("code",[v._v("version+1")])]),v._v(" "),t("li",[v._v("对数据更新时，添加条件，条件成立执行")]),v._v(" "),t("li",[v._v("token：客户端向服务端发送请求，服务端生成唯一数据存入到Redis，客户端第二次请求携带token，Redis查询数据token存在，继续业务并且把token删除，没有则代表重复")]),v._v(" "),t("li",[t("code",[v._v("Redis")]),v._v("的"),t("code",[v._v("setnx")]),v._v("，设置成功返回1，失败返回0，代表重复")]),v._v(" "),t("li",[v._v("MySQL的唯一索引，插入成功继续业务，失败代表重复")])])]),v._v(" "),t("li",[v._v("总结：\n"),t("ul",[t("li",[v._v("解决前端表单多次提交")]),v._v(" "),t("li",[v._v("解决"),t("code",[v._v("RPC")]),v._v("失败重试消息重复")]),v._v(" "),t("li",[v._v("请求处理到一半，网络断开，导致一些脏数据库写入数据库")]),v._v(" "),t("li",[v._v("消息队列，消息消费到一半，网络断开，导致消息回到队列")])])])]),v._v(" "),t("h3",{attrs:{id:"protected、final、static"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#protected、final、static"}},[v._v("#")]),v._v(" protected、final、static")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("protected")]),v._v("：")])]),v._v(" "),t("table",[t("thead",[t("tr",[t("th"),v._v(" "),t("th",[v._v("当前类")]),v._v(" "),t("th",[v._v("同一包")]),v._v(" "),t("th",[v._v("子类")]),v._v(" "),t("th",[v._v("不同包")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("public")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")])]),v._v(" "),t("tr",[t("td",[v._v("protected")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("不可用")])]),v._v(" "),t("tr",[t("td",[v._v("default")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("不可用")]),v._v(" "),t("td",[v._v("不可用")])]),v._v(" "),t("tr",[t("td",[v._v("private")]),v._v(" "),t("td",[v._v("可以")]),v._v(" "),t("td",[v._v("不可用")]),v._v(" "),t("td",[v._v("不可用")]),v._v(" "),t("td",[v._v("不可用")])])])]),v._v(" "),t("ul",[t("li",[t("code",[v._v("final")]),v._v("：类、方法和属性\n"),t("ul",[t("li",[v._v("类：不可被继承")]),v._v(" "),t("li",[v._v("方法：不能被重写")]),v._v(" "),t("li",[v._v("属性：常量，不可修改")])])]),v._v(" "),t("li",[t("code",[v._v("static")]),v._v("：方法、属性\n"),t("ul",[t("li",[v._v("静态方法、静态变量")]),v._v(" "),t("li",[v._v("全局方法、全局变量")])])])]),v._v(" "),t("h3",{attrs:{id:"哈希冲突"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#哈希冲突"}},[v._v("#")]),v._v(" 哈希冲突")]),v._v(" "),t("ul",[t("li",[v._v("hash：散列表")]),v._v(" "),t("li",[v._v("冲突：一个输入被散列，相当于压缩，有可能导致不同的输入得到相同输出，导致地址已被占用")]),v._v(" "),t("li",[v._v("解决：\n"),t("ul",[t("li",[v._v("开放地址法："),t("code",[v._v("hash")]),v._v("值地址冲突，再以hash值为"),t("code",[v._v("key")]),v._v("得到新的hash值，直到hash值没有冲突")]),v._v(" "),t("li",[v._v("再哈希法：冲突后，使用新的hash函数计算新的hash值（前提：需要多个hash函数）")]),v._v(" "),t("li",[v._v("链地址法（常用）："),t("code",[v._v("HashMap")]),v._v("底层使用，原理单链表，hash值冲突，添加到末尾（尾插法）")]),v._v(" "),t("li",[v._v("建立公共溢出区：没有冲突放到基本表，冲突的放到溢出表")])])])]),v._v(" "),t("h3",{attrs:{id:"hashmap扩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hashmap扩容"}},[v._v("#")]),v._v(" HashMap扩容")]),v._v(" "),t("p",[v._v("初始容量16（使用才16，否则默认为0），扩容因子3/4，即容量到12时就扩容。扩容后为32（原来的一倍），其次为64，最后大于64，节点超过8就树化（树化两个必备：节点超过8，容量超过64）")]),v._v(" "),t("p",[v._v("退化：扩容后导致节点数量小于6，树的左或右或左左节点为null")]),v._v(" "),t("h3",{attrs:{id:"concurrenthashmap和hashmap区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#concurrenthashmap和hashmap区别"}},[v._v("#")]),v._v(" ConcurrentHashMap和HashMap区别")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("主要区别：安全方面，单线程和多线程，延伸到并发下添加和获取")])]),v._v(" "),t("li",[t("p",[v._v("HashMap：")]),v._v(" "),t("ul",[t("li",[v._v("1.7：数组+链表")]),v._v(" "),t("li",[v._v("1.8：数组+链表/红黑树")]),v._v(" "),t("li",[v._v("索引：计算hash值后，二次hash算索引，"),t("code",[v._v("capacity-1&hash")])])])]),v._v(" "),t("li",[t("p",[v._v("ConcurrentHashMap：")]),v._v(" "),t("ul",[t("li",[v._v("1.7：segment（片段），HashEntry（片段下的数据），每个片段独立，segment不能扩容，并发度一开始固定，每个segment一把锁synchronized")]),v._v(" "),t("li",[v._v("1.8：数组+链表/红黑树，CAS")]),v._v(" "),t("li",[v._v("扩容并发获取get：根据forwardingnode片段，不是则正常get，是则到新数组get")]),v._v(" "),t("li",[v._v("扩容并发添加put：片段forwardingnode（后往前）\n"),t("ul",[t("li",[v._v("不在，可以并发添加")]),v._v(" "),t("li",[v._v("在，协助扩容")]),v._v(" "),t("li",[v._v("刚好到，阻塞")])])])])])])])}),[],!1,null,null,null);_.default=e.exports}}]);